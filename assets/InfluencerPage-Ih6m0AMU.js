const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GradeConfigModal-P5WE3TZs.js","assets/framer-motion-6E75tBg3.js","assets/react-vendor-9l3RvKiN.js","assets/dialog-CRjbffcy.js","assets/SortPanel-CCg77oLu.js","assets/index-kvcITcEx.js","assets/tanstack-query-BtejbdqV.js","assets/ColumnSettingsPanel-Cf8148gh.js","assets/MemoEditModal-og1epeUC.js","assets/AnalyzerDrawer-BHMhsg2P.js","assets/useAnalyzerData-B2JgJSSy.js","assets/copy-Ck-R7ZBU.js"])))=>i.map(i=>d[i]);
import{_ as he}from"./index-DFGoSxIl.js";import{j as e}from"./framer-motion-6E75tBg3.js";import{r as s}from"./react-vendor-9l3RvKiN.js";import{S as Se,I as _e,c as f,a as ze,M as Z,G as Ie,D as Ne,H as ve,s as Pe,C as J,b as Oe,d as ne,E as je,e as xe,f as F,U as Re,B as U,u as Te,g as Ae,h as Fe,i as Ue,j as Ge,k as Ve,l as Be,m as He,n as We,o as qe,p as Ye,X as Ke}from"./SortPanel-CCg77oLu.js";import{c as ue}from"./index-kvcITcEx.js";import{B as Me,M as Ee,P as De,R as $e}from"./badge-D35L35S-.js";import"./tanstack-query-BtejbdqV.js";const Qe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Je=ue("clipboard-list",Qe);const Xe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ze=ue("settings",Xe);const et=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],tt=ue("sliders-vertical",et);const st=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],me=ue("star",st);function at({searchQuery:g,onSearchChange:h,categoryOptions:k,selectedCategories:u,onCategoriesChange:p,selectedGrades:d,onGradesChange:C,updateStatusOptions:S,selectedUpdateStatus:x,onUpdateStatusChange:z,showFavoritesOnly:w,onFavoritesToggle:B,mobileFiltersOpen:E,onMobileFiltersToggle:P}){const[D,_]=s.useState(g);s.useEffect(()=>{const v=setTimeout(()=>{h(D)},250);return()=>clearTimeout(v)},[D,h]);const O=u.length+d.length+x.length;return e.jsxs("div",{children:[e.jsx("div",{className:"md:hidden",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"relative flex-1 min-w-0",children:[e.jsx(Se,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-admin-text"}),e.jsx(_e,{type:"text",placeholder:"ID ÎòêÎäî Ïù¥Î¶Ñ Í≤ÄÏÉâ...",value:D,onChange:v=>_(v.target.value),className:"pl-8 h-8 text-[13px] bg-admin-card border-admin-border text-white placeholder:text-admin-text"})]}),e.jsx("button",{onClick:B,className:f("flex items-center justify-center h-8 w-8 rounded-md border shrink-0 transition-colors",w?"bg-amber-500/20 border-amber-500/40 text-amber-400":"bg-admin-card border-admin-border text-admin-text/40"),children:e.jsx(me,{className:f("h-3.5 w-3.5",w&&"fill-amber-400")})}),e.jsxs("button",{onClick:P,className:f("relative flex items-center justify-center h-8 w-8 rounded-md border shrink-0 transition-colors",E||O>0?"bg-admin-accent/15 border-admin-accent/40 text-admin-accent":"bg-admin-card border-admin-border text-admin-text"),children:[e.jsx(ze,{className:"h-3.5 w-3.5"}),O>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 min-w-[16px] h-4 flex items-center justify-center rounded-full bg-admin-accent text-[10px] font-bold text-admin-bg px-1",children:O})]})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 min-w-0",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-admin-text"}),e.jsx(_e,{type:"text",placeholder:"ID ÎòêÎäî Ïù¥Î¶Ñ Í≤ÄÏÉâ...",value:D,onChange:v=>_(v.target.value),className:"pl-10 bg-admin-card border-admin-border text-white placeholder:text-admin-text"})]}),e.jsx(Z,{options:k,selected:u,onChange:p,placeholder:"Ïπ¥ÌÖåÍ≥†Î¶¨",className:"w-[155px] shrink-0"}),e.jsx(Z,{options:Ie,selected:d,onChange:C,placeholder:"Îì±Í∏â",className:"w-[125px] shrink-0"}),e.jsx(Z,{options:S,selected:x,onChange:z,placeholder:"ÏóÖÎç∞Ïù¥Ìä∏",className:"w-[145px] shrink-0"})]})]})}function nt(g){const h=g.reduce((d,C)=>d+(J[C]?.width||120),0),k={},u=[];let p=0;for(let d=0;d<g.length;d++){const C=J[g[d]]?.width||120,S=C/h*100;k[g[d]]=`${S}%`,d<ne&&(u.push(`${p/h*100}%`),p+=C)}return{total:h,pctWidths:k,stickyOffsets:u}}function rt({data:g,headers:h,visibleColumns:k,onCellEdit:u,onMemoEdit:p,highlightId:d,stickyTopOffset:C=0,sortRules:S=[],mode:x="manage",selectedIds:z,disabledIds:w,onToggleSelect:B}){const[E,P]=s.useState(null),[D,_]=s.useState(""),O=s.useMemo(()=>Ne.filter(t=>k.includes(t)&&!ve.includes(t)),[k]),v=s.useMemo(()=>nt(O),[O]),G=s.useMemo(()=>Pe(g,S,(t,i)=>String(t[i]||"")),[g,S]),H=s.useRef(null),y=s.useRef(null),I=s.useRef(!1);s.useEffect(()=>{if(!d||!y.current)return;const t=y.current.querySelector(`[data-insta-id="${d}"]`);t&&t.scrollIntoView({block:"center",behavior:"smooth"})},[d,G]);const R=(t,i,r,n)=>{if(x==="select")return;const l=J[i];l&&(l.type==="editable-memo"?p(t,r,n):(l.type==="editable-number"||l.type==="editable-boolean")&&(P({rowIndex:t,column:i}),_(r)))},W=(t,i)=>{if(E?.rowIndex===t&&E?.column===i){const r=h.indexOf(i);r!==-1&&u(t,r,D),P(null),_("")}},L=(t,i,r)=>{t.key==="Enter"?W(i,r):t.key==="Escape"&&(P(null),_(""))},ee=(t,i,r)=>{const n=String(t[i]||""),l=J[i];if(!l)return n;const m=h.indexOf(i),N=E?.rowIndex===r&&E?.column===i;if(l.type==="editable-memo")return e.jsxs("button",{onClick:()=>R(r,i,n,t["Ïù∏Ïä§ÌÉÄ Ïù¥Î¶Ñ"]),className:"w-full text-left group/memo relative",children:[e.jsx("span",{className:"whitespace-pre-wrap break-words text-[13px] leading-relaxed text-white/90",children:n||"-"}),e.jsx("span",{className:"absolute top-0 right-0 opacity-0 group-hover/memo:opacity-100 transition-opacity",children:e.jsx(De,{className:"h-3 w-3 text-admin-accent"})})]});if(l.type==="editable-number"){const o=n&&n!=="-"?n:"0";return N?e.jsx("input",{type:"text",value:D,onChange:b=>_(b.target.value),onBlur:()=>W(r,i),onKeyDown:b=>L(b,r,i),autoFocus:!0,className:"w-full px-1.5 py-0.5 bg-admin-bg border border-admin-accent rounded text-white text-right text-[13px] focus:outline-none"}):e.jsx("button",{onClick:()=>R(r,i,n,""),className:"w-full text-right tabular-nums text-[13px] text-admin-accent/80 hover:text-admin-accent border-b border-dashed border-admin-border hover:border-admin-accent/50 transition-colors",children:F(o)})}if(l.type==="editable-boolean"){const o=n.trim().toUpperCase()==="ON";return e.jsx(U,{size:"sm",variant:"outline",onClick:()=>{u(r,m,o?"OFF":"ON")},className:f("h-6 px-2 text-[11px] font-semibold rounded-full",o?"bg-admin-success/15 text-admin-success border-admin-success/30 hover:bg-admin-success/25":"bg-gray-500/15 text-gray-500 border-gray-500/30 hover:bg-gray-500/25"),children:o?"ON":"OFF"})}if(l.type==="favorite"){const o=n.trim().toUpperCase()==="TRUE";return e.jsx("button",{onClick:()=>{const b=h.indexOf(i);b!==-1&&u(r,b,o?"FALSE":"TRUE")},className:"flex items-center justify-center w-full",children:e.jsx(me,{className:f("h-4 w-4 transition-colors",o?"fill-amber-400 text-amber-400":"text-admin-text/30 hover:text-amber-400/60")})})}if(l.type==="id"){const o=t["ÌîÑÎ°úÌïÑ ÎßÅÌÅ¨"];return e.jsxs("span",{className:"inline-flex items-center gap-1 max-w-full",children:[e.jsx("button",{onClick:()=>p(r,String(t.Î©îÎ™®||""),t["Ïù∏Ïä§ÌÉÄ Ïù¥Î¶Ñ"]),className:"text-admin-accent hover:underline text-[13px] font-medium truncate min-w-0",children:n}),o&&e.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-admin-text/50 hover:text-admin-accent transition-colors shrink-0",onClick:b=>b.stopPropagation(),children:e.jsx(je,{className:"h-3 w-3"})})]})}if(l.type==="name")return e.jsx("span",{className:"text-[13px] text-white whitespace-normal break-words leading-snug",children:n});if(l.type==="link")return!n||n==="-"?e.jsx("span",{className:"text-admin-text/40",children:"-"}):e.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-admin-accent/70 hover:text-admin-accent transition-colors",children:e.jsx(je,{className:"h-3.5 w-3.5 mx-auto"})});if(l.type==="number")return e.jsx("span",{className:"tabular-nums text-[13px]",children:F(n)});if(l.type==="tag")return!n||n==="-"?e.jsx("span",{className:"text-admin-text/40",children:"-"}):e.jsx("span",{className:"text-[12px] text-admin-purple whitespace-normal break-words",children:n});if(l.type==="boolean"){const o=n.trim().toUpperCase()==="Y"||n.trim()==="O";return e.jsx("span",{className:f("text-[11px] font-bold",o?"text-admin-success":"text-admin-text/40"),children:o?"Y":"N"})}if(l.type==="grade"){if(!n||n==="-")return e.jsx("span",{className:"text-admin-text/40",children:"-"});const o=xe[n]||xe.C;return e.jsx(Me,{variant:"outline",className:f("font-bold text-[11px] px-2 py-0",o),children:n})}return l.type==="text-wrap"?!n||n==="-"?e.jsx("span",{className:"text-admin-text/40",children:"-"}):e.jsx("span",{className:"whitespace-normal break-words text-[13px] leading-snug text-white/80",children:n}):l.type==="desc"?e.jsx("span",{className:"text-[13px] text-admin-text",children:n||"-"}):e.jsx("span",{className:"text-[13px]",children:n})},q=(t,i,r)=>{P({rowIndex:t,column:i}),_(r&&r!=="-"?r:"0")},re=()=>e.jsx("div",{className:"md:hidden space-y-3",children:G.map(t=>{const i=String(t.Ïù∏Ïä§ÌÉÄID||""),r=String(t["Ïù∏Ïä§ÌÉÄ Ïù¥Î¶Ñ"]||""),n=String(t["Ïù∏ÌîåÎ£®Ïñ∏ÏÑú Îì±Í∏â"]||""),l=String(t["Ïπ¥ÌÖåÍ≥†Î¶¨(ÎåÄ)"]||""),m=String(t["Ïπ¥ÌÖåÍ≥†Î¶¨(Ï§ë)"]||""),N=String(t.ÌåîÎ°úÏõå||""),o=String(t["ÏµúÍ∑º 10 ÌèâÍ∑† Î¶¥Ïä§ Ï°∞ÌöåÏàò"]||""),b=String(t["ÏµúÎåÄ Î¶¥Ïä§ Ï°∞ÌöåÏàò"]||""),T=String(t["ÏµúÍ∑º10Í∞ú ÌèâÍ∑† ÎåìÍ∏ÄÏàò"]||""),Y=String(t["Í≥µÍµ¨ ÌèâÍ∑†ÎåìÍ∏ÄÏàò"]||""),A=String(t["Í≥µÍµ¨ ÏµúÎåÄÎåìÍ∏ÄÏàò"]||""),K=String(t.ÎßàÏßÄÎßâÍ≤åÏãúÎ¨º||""),te=String(t.ÏóÖÎç∞Ïù¥Ìä∏ÏùºÏûê||""),$=String(t["Í≥µÏßÄÏ±ÑÎÑê Î©§Î≤ÑÏàò"]||""),ce=String(t.Ïä§ÌÜ†Î¶¨ÌôúÎèô||"").trim().toUpperCase(),se=String(t.ÏÜåÌÜµÏ±ÑÎÑêÏó¨Î∂Ä||"").trim(),X=String(t.ÎåìÍ∏ÄÌôúÎèôÏó¨Î∂Ä||"").trim(),V=String(t.Î©îÎ™®||""),oe=String(t.Ï¶êÍ≤®Ï∞æÍ∏∞||"").trim().toUpperCase()==="TRUE",de=t["ÌîÑÎ°úÌïÑ ÎßÅÌÅ¨"],be=xe[n]||xe.C,fe=E?.rowIndex===t._rowIndex&&E?.column==="Í≥µÏßÄÏ±ÑÎÑê Î©§Î≤ÑÏàò",ae=x==="select"&&z?.has(i),Q=x==="select"&&w?.has(i);return e.jsxs("div",{"data-insta-id":i,onClick:x==="select"&&!Q?()=>B?.(t):void 0,className:f("rounded-lg p-3 transition-colors duration-500",x==="select"&&Q&&"opacity-30 cursor-not-allowed",x==="select"&&!Q&&"cursor-pointer",ae||d===i?"bg-admin-accent/10 border-2 border-admin-accent/40":"bg-admin-card border border-admin-border"),children:[x==="select"&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:f("w-5 h-5 rounded border flex items-center justify-center shrink-0",Q?"border-[#2a2a3a] bg-[#1a1a2a]":ae?"bg-amber-500 border-amber-500":"border-[#3a3a4a]"),children:ae&&e.jsx(Oe,{className:"h-3 w-3 text-black",strokeWidth:3})}),Q&&e.jsx("span",{className:"text-[10px] text-admin-accent/60",children:"Ï∂îÍ∞ÄÎê®"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsxs("button",{onClick:M=>{M.stopPropagation(),p(t._rowIndex,V,r)},className:"text-admin-accent hover:underline text-sm font-medium truncate min-w-0",children:["@",i]}),de&&e.jsx("a",{href:de,target:"_blank",rel:"noopener noreferrer",className:"text-admin-text/50 hover:text-admin-accent transition-colors shrink-0",onClick:M=>M.stopPropagation(),children:e.jsx(je,{className:"h-3.5 w-3.5"})}),n&&n!=="-"&&e.jsx(Me,{variant:"outline",className:f("font-bold text-[11px] px-2 py-0 shrink-0",be),children:n})]}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsx("button",{onClick:()=>{const M=h.indexOf("Ï¶êÍ≤®Ï∞æÍ∏∞");M!==-1&&u(t._rowIndex,M,oe?"FALSE":"TRUE")},children:e.jsx(me,{className:f("h-4 w-4 transition-colors",oe?"fill-amber-400 text-amber-400":"text-admin-text/30 hover:text-amber-400/60")})})})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsx("span",{className:"text-white text-[13px] font-medium truncate",children:r}),l&&l!=="-"&&e.jsx("span",{className:"text-[11px] text-admin-purple shrink-0",children:l}),m&&m!=="-"&&m!==l&&e.jsx("span",{className:"text-[11px] text-admin-text/50 shrink-0",children:m})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 mb-1",children:[e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÌåîÎ°úÏõå"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:N&&N!=="-"?F(N):"-"})]}),e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÌèâÍ∑†Ï°∞Ìöå"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:o&&o!=="-"?F(o):"-"})]}),e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÏµúÎåÄÏ°∞Ìöå"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:b&&b!=="-"?F(b):"-"})]}),e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÌèâÍ∑†ÎåìÍ∏Ä"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:T&&T!=="-"?F(T):"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 mb-2",children:[e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"Í≥µÍµ¨ÌèâÍ∑†üí¨"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:Y&&Y!=="-"?F(Y):"-"})]}),e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"Í≥µÍµ¨ÏµúÎåÄüí¨"}),e.jsx("p",{className:"text-[13px] text-white tabular-nums font-medium",children:A&&A!=="-"?F(A):"-"})]}),K&&K!=="-"&&e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÎßàÏßÄÎßâÍ≤åÏãúÎ¨º"}),e.jsx("p",{className:"text-[11px] text-white/80",children:K})]}),te&&te!=="-"&&e.jsxs("div",{className:"bg-admin-bg/40 rounded px-2 py-1.5 text-center",children:[e.jsx("p",{className:"text-[10px] text-admin-text/60 mb-0.5",children:"ÏóÖÎç∞Ïù¥Ìä∏"}),e.jsx("p",{className:"text-[11px] text-white/80",children:te})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Re,{className:"h-3 w-3 text-admin-text/60"}),e.jsx("span",{className:"text-[11px] text-admin-text/60",children:"Î©§Î≤ÑÏàò"}),fe?e.jsx("input",{type:"text",value:D,onChange:M=>_(M.target.value),onBlur:()=>W(t._rowIndex,"Í≥µÏßÄÏ±ÑÎÑê Î©§Î≤ÑÏàò"),onKeyDown:M=>L(M,t._rowIndex,"Í≥µÏßÄÏ±ÑÎÑê Î©§Î≤ÑÏàò"),autoFocus:!0,className:"w-16 px-1.5 py-0.5 bg-admin-bg border border-admin-accent rounded text-white text-right text-[12px] focus:outline-none"}):e.jsx("button",{onClick:()=>q(t._rowIndex,"Í≥µÏßÄÏ±ÑÎÑê Î©§Î≤ÑÏàò",$),className:"text-[12px] text-admin-accent/80 hover:text-admin-accent tabular-nums border-b border-dashed border-admin-border hover:border-admin-accent/50 transition-colors",children:$&&$!=="-"?F($):"0"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ce==="ON"&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-admin-success/15 text-admin-success border border-admin-success/30",children:"Ïä§ÌÜ†Î¶¨"}),(se==="Y"||se==="O")&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-teal-500/15 text-teal-400 border border-teal-500/30",children:"ÏÜåÌÜµ"}),(X==="Y"||X==="O")&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-purple-500/15 text-purple-400 border border-purple-500/30",children:"ÎåìÍ∏Ä"})]})]}),V&&V!=="-"?e.jsx("button",{onClick:()=>p(t._rowIndex,V,r),className:"w-full text-left group/memo",children:e.jsxs("div",{className:"bg-admin-bg/50 rounded px-2.5 py-1.5 flex items-start gap-2",children:[e.jsx(Ee,{className:"h-3 w-3 text-admin-text mt-0.5 shrink-0"}),e.jsx("p",{className:"text-[12px] text-white/70 whitespace-pre-wrap break-words line-clamp-2 flex-1",children:V}),e.jsx(De,{className:"h-3 w-3 text-admin-accent opacity-0 group-hover/memo:opacity-100 transition-opacity shrink-0 mt-0.5"})]})}):e.jsx("button",{onClick:()=>p(t._rowIndex,"",r),className:"w-full text-left",children:e.jsxs("div",{className:"bg-admin-bg/50 rounded px-2.5 py-1.5 flex items-center gap-2 text-admin-text/40 hover:text-admin-text/60 transition-colors",children:[e.jsx(Ee,{className:"h-3 w-3 shrink-0"}),e.jsx("span",{className:"text-[12px]",children:"Î©îÎ™® Ï∂îÍ∞Ä..."})]})})]},t._rowIndex)})}),ie=()=>{I.current||(I.current=!0,H.current&&y.current&&(y.current.scrollLeft=H.current.scrollLeft),requestAnimationFrame(()=>{I.current=!1}))},pe=()=>{I.current||(I.current=!0,H.current&&y.current&&(H.current.scrollLeft=y.current.scrollLeft),requestAnimationFrame(()=>{I.current=!1}))},le=s.useMemo(()=>e.jsxs("colgroup",{children:[x==="select"&&e.jsx("col",{style:{width:40}}),O.map(t=>e.jsx("col",{style:{width:v.pctWidths[t]}},t))]}),[x,O,v.pctWidths]);return e.jsxs(e.Fragment,{children:[re(),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"sticky z-40 border border-admin-border border-b-0 rounded-t-lg bg-[#14142a]",style:{top:C},children:e.jsx("div",{ref:H,className:"overflow-x-auto",style:{scrollbarWidth:"none"},onScroll:ie,children:e.jsxs("table",{className:"w-full text-sm border-collapse",style:{minWidth:v.total,tableLayout:"fixed"},children:[le,e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#14142a]",children:[x==="select"&&e.jsx("th",{className:"px-2 py-2.5 text-center w-10"}),O.map((t,i)=>{const r=J[t],n=i<ne,l=i===ne-1;return e.jsx("th",{style:n?{left:v.stickyOffsets[i]}:void 0,className:f("px-2.5 py-2.5 text-[11px] uppercase tracking-wider text-admin-text/70 font-semibold border-r border-admin-border/50 last:border-r-0",n&&"sticky z-40 bg-[#14142a]",l&&"shadow-[3px_0_8px_rgba(0,0,0,0.35)] border-r-admin-border",r?.align==="center"&&"text-center",r?.align==="right"&&"text-right"),children:e.jsx("span",{className:"whitespace-nowrap",children:r?.label||t})},t)})]})})]})})}),e.jsx("div",{className:"border border-admin-border border-t-0 rounded-b-lg overflow-hidden",children:e.jsx("div",{ref:y,className:"overflow-auto",style:{maxHeight:"calc(100vh - 220px)"},onScroll:pe,children:e.jsxs("table",{className:"w-full text-sm border-collapse",style:{minWidth:v.total,tableLayout:"fixed"},children:[le,e.jsx("tbody",{children:G.map((t,i)=>{const r=String(t.Ïù∏Ïä§ÌÉÄID||""),n=d===r;return e.jsxs("tr",{"data-insta-id":r,onClick:x==="select"&&!w?.has(r)?()=>B?.(t):void 0,className:f("border-b border-admin-border/40 transition-colors duration-500",x==="select"&&w?.has(r)&&"opacity-30 cursor-not-allowed",x==="select"&&!w?.has(r)&&"cursor-pointer",x==="select"&&z?.has(r)?"bg-amber-500/[0.07]":n?"bg-admin-accent/10 ring-1 ring-admin-accent/40":i%2===0?"bg-[#11111f]":"bg-[#151528]","hover:bg-white/[0.02]"),children:[x==="select"&&(()=>{const l=String(t.Ïù∏Ïä§ÌÉÄID||""),m=z?.has(l),N=w?.has(l);return e.jsx("td",{className:"px-2 py-2 text-center align-top",children:e.jsx("div",{className:f("w-5 h-5 rounded border flex items-center justify-center mx-auto",N?"border-[#2a2a3a] bg-[#1a1a2a] opacity-30":m?"bg-amber-500 border-amber-500":"border-[#3a3a4a] bg-transparent"),children:m&&e.jsx(Oe,{className:"h-3 w-3 text-black",strokeWidth:3})})})})(),O.map((l,m)=>{const N=J[l],o=m<ne,b=m===ne-1,T=i%2===0?"#11111f":"#151528";return e.jsx("td",{style:o?{left:v.stickyOffsets[m],backgroundColor:T}:void 0,className:f("px-2.5 py-2 text-white border-r border-admin-border/30 last:border-r-0 align-top",o&&"sticky z-30",b&&"shadow-[3px_0_8px_rgba(0,0,0,0.35)] border-r-admin-border/60",N?.align==="center"&&"text-center",N?.align==="right"&&"text-right",N?.highlight&&"font-semibold"),children:ee(t,l,t._rowIndex)},l)})]},t._rowIndex)})})]})})})]})]})}const it=s.memo(rt),lt=s.lazy(()=>he(()=>import("./GradeConfigModal-P5WE3TZs.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),ct=s.lazy(()=>he(()=>import("./ColumnSettingsPanel-Cf8148gh.js"),__vite__mapDeps([7,1,2,4,5,6]))),ot=s.lazy(()=>he(()=>import("./MemoEditModal-og1epeUC.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),dt=s.lazy(()=>he(()=>import("./AnalyzerDrawer-BHMhsg2P.js"),__vite__mapDeps([9,1,2,6,5,4,10,11]))),xt=new Set(["number","editable-number","grade","desc","tag","name"]),mt=["2Ï£º Ï¥àÍ≥º","ÏóÜÏùå"];function vt(){const{data:g,isLoading:h,error:k}=Te(),u=Ae(),p=Fe(),{data:d,isLoading:C}=Ue(),S=Ge(),{data:x}=Ve(),z=Be(),{data:w}=He(),{data:B}=We(),E=qe(),P=s.useMemo(()=>B?.rules??[],[B]),D=s.useCallback(a=>{E.mutate(a)},[E]),_=s.useRef(null),[O,v]=s.useState(0);s.useEffect(()=>{const a=_.current;if(!a)return;const c=new ResizeObserver(()=>{v(a.offsetHeight)});return c.observe(a),()=>c.disconnect()},[]);const[G,H]=s.useState(""),[y,I]=s.useState([]),[R,W]=s.useState([]),[L,ee]=s.useState([]),[q,re]=s.useState(!1),[ie,pe]=s.useState(!1),[le,t]=s.useState(!1),[i,r]=s.useState(!1),[n,l]=s.useState(!1),[m,N]=s.useState({isOpen:!1,rowIndex:-1,value:"",name:""}),[o,b]=s.useState(null),[T,Y]=s.useState(!1);s.useEffect(()=>{const a=c=>{c.data?.type==="ig-analyzer-result"&&c.data.payload&&(b(c.data.payload),Y(!0))};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[]),s.useEffect(()=>{const a=window.location.hash;if(a.startsWith("#analyzer="))try{const c=a.slice(10),j=JSON.parse(decodeURIComponent(c));j.username&&j.profile&&(b(j),Y(!0),history.replaceState(null,"",window.location.pathname))}catch{}},[]);const A=s.useMemo(()=>g?.data??[],[g?.data]),K=g?.headers||[],te=g?.fromCache??!1,$=s.useMemo(()=>d?.columns?d.columns.filter(a=>a.visible).map(a=>a.name):Ne.filter(a=>!ve.includes(a)),[d]),ce=s.useMemo(()=>{const a=new Set;return A.forEach(c=>{const j=c["Ïπ¥ÌÖåÍ≥†Î¶¨(ÎåÄ)"];j&&j!=="-"&&a.add(j)}),Array.from(a).sort()},[A]),se=mt,X=s.useMemo(()=>A.filter(a=>{if(q&&String(a.Ï¶êÍ≤®Ï∞æÍ∏∞||"").trim().toUpperCase()!=="TRUE")return!1;if(G){const c=G.toLowerCase(),j=String(a.Ïù∏Ïä§ÌÉÄID||"").toLowerCase(),ge=String(a["Ïù∏Ïä§ÌÉÄ Ïù¥Î¶Ñ"]||"").toLowerCase();if(!j.includes(c)&&!ge.includes(c))return!1}if(y.length>0){const c=a["Ïπ¥ÌÖåÍ≥†Î¶¨(ÎåÄ)"];if(!y.includes(c))return!1}if(R.length>0){const c=a["Ïù∏ÌîåÎ£®Ïñ∏ÏÑú Îì±Í∏â"];if(!R.includes(c))return!1}if(L.length>0){const c=String(a.ÏóÖÎç∞Ïù¥Ìä∏ÏùºÏûê||"").trim(),j=!c||c==="-",ge=Date.now(),Le=336*60*60*1e3,Ce=!j&&ge-new Date(c).getTime()>Le,we=L.includes("2Ï£º Ï¥àÍ≥º"),ke=L.includes("ÏóÜÏùå");if(we&&ke){if(!Ce&&!j)return!1}else if(we){if(!Ce)return!1}else if(ke&&!j)return!1}return!0}),[A,G,y,R,L,q]),V=s.useCallback(()=>{u.mutate()},[u]),ye=s.useCallback((a,c,j)=>{p.mutate({rowIndex:a,columnIndex:c,value:j})},[p]),oe=s.useCallback((a,c,j)=>{N({isOpen:!0,rowIndex:a,value:c,name:j})},[]),de=s.useCallback(a=>{const c=K.indexOf("Î©îÎ™®");c!==-1&&p.mutate({rowIndex:m.rowIndex,columnIndex:c,value:a}),N({isOpen:!1,rowIndex:-1,value:"",name:""})},[K,m.rowIndex,p]),be=s.useCallback(a=>{S.mutate(a),l(!1)},[S]),fe=s.useCallback((a,c)=>{z.mutate({grades:a,applyFormula:c}),r(!1)},[z]),ae=s.useCallback(a=>{s.startTransition(()=>{H(a)})},[]),Q=s.useCallback(()=>r(!0),[]),M=s.useCallback(()=>l(!0),[]);return k?e.jsx("div",{className:"max-w-[1800px] mx-auto mt-8",children:e.jsxs("div",{className:"bg-admin-error/20 border border-admin-error/40 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-admin-error font-semibold",children:"Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§"}),e.jsx("p",{className:"text-admin-text text-sm mt-2",children:String(k)}),e.jsx(U,{onClick:V,className:"mt-4",children:"Îã§Ïãú ÏãúÎèÑ"})]})}):e.jsxs("div",{className:"max-w-[1800px] mx-auto mt-4 md:mt-8",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white mb-1 md:mb-2",children:"Ïù∏ÌîåÎ£®Ïñ∏ÏÑú Í¥ÄÎ¶¨"}),w&&e.jsxs("div",{className:"flex items-center gap-4 text-xs text-admin-text",children:[e.jsxs("span",{children:["Cache: ",te?"KV":"API"]}),e.jsxs("span",{children:["Quota: ",w.quotaUsed," / 100"]}),e.jsxs("span",{children:["Hits: ",w.cacheHits," / Misses: ",w.cacheMisses]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(U,{onClick:Q,variant:"outline",className:"bg-transparent border-admin-border text-white hover:bg-admin-bg",children:[e.jsx(tt,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Îì±Í∏â ÏÑ§Ï†ï"})]}),e.jsxs(U,{onClick:M,variant:"outline",className:"bg-transparent border-admin-border text-white hover:bg-admin-bg",children:[e.jsx(Ze,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Ïª¨Îüº ÏÑ§Ï†ï"})]})]})]}),e.jsxs("div",{ref:_,className:"sticky top-0 z-50 bg-admin-bg py-2 md:pt-2 md:pb-3 -mx-3 px-3 md:-mx-6 md:px-6 shadow-[0_4px_12px_rgba(0,0,0,0.3)]",children:[e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(at,{searchQuery:G,onSearchChange:ae,categoryOptions:ce,selectedCategories:y,onCategoriesChange:I,selectedGrades:R,onGradesChange:W,updateStatusOptions:se,selectedUpdateStatus:L,onUpdateStatusChange:ee,showFavoritesOnly:q,onFavoritesToggle:()=>re(a=>!a),mobileFiltersOpen:ie,onMobileFiltersToggle:()=>pe(a=>!a)})}),e.jsxs(U,{onClick:()=>re(a=>!a),variant:"outline",size:"sm",className:f("hidden md:flex shrink-0 gap-1.5",q?"bg-amber-500/15 border-amber-500/40 text-amber-400 hover:bg-amber-500/25 hover:text-amber-400":"bg-transparent border-admin-border text-admin-text hover:bg-admin-bg hover:text-white"),children:[e.jsx(me,{className:f("h-3.5 w-3.5",q&&"fill-amber-400")}),e.jsx("span",{className:"text-xs",children:"Ï¶êÍ≤®Ï∞æÍ∏∞"})]}),e.jsx(Ye,{columns:$.filter(a=>xt.has(J[a]?.type)),rules:P,onChange:D}),e.jsx(U,{onClick:()=>t(!0),variant:"outline",size:"sm",className:"hidden md:flex bg-transparent border-admin-border text-white hover:bg-admin-bg shrink-0",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(U,{onClick:V,disabled:u.isPending,variant:"outline",size:"sm",className:"bg-transparent border-admin-border text-white hover:bg-admin-bg shrink-0",children:e.jsx($e,{className:f("h-4 w-4",u.isPending&&"animate-spin")})})]}),ie&&e.jsxs("div",{className:"md:hidden mt-2 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Z,{options:ce,selected:y,onChange:I,placeholder:"Ïπ¥ÌÖåÍ≥†Î¶¨"}),e.jsx(Z,{options:Ie,selected:R,onChange:W,placeholder:"Îì±Í∏â"}),e.jsx(Z,{options:se,selected:L,onChange:ee,placeholder:"ÏóÖÎç∞Ïù¥Ìä∏"})]}),y.length+R.length+L.length>0&&e.jsxs("button",{onClick:()=>{I([]),W([]),ee([])},className:"flex items-center gap-1 text-[11px] text-admin-text hover:text-admin-accent transition-colors self-end",children:[e.jsx(Ke,{className:"h-3 w-3"}),"ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî"]})]}),e.jsxs("div",{className:"text-[11px] md:text-sm text-admin-text mt-1.5",children:[e.jsx("span",{className:"text-white font-semibold",children:X.length})," / ",A.length," Í±¥"]})]}),h||C?e.jsx("div",{className:"flex items-center justify-center h-64 bg-admin-card rounded-lg border border-admin-border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-admin-accent mx-auto mb-4"}),e.jsx("p",{className:"text-admin-text",children:"Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë..."})]})}):e.jsx(it,{data:X,headers:K,visibleColumns:$,onCellEdit:ye,onMemoEdit:oe,highlightId:T?o?.username??null:null,stickyTopOffset:O,sortRules:P}),i&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(lt,{isOpen:i,onClose:()=>r(!1),grades:x?.grades||[],onSave:fe,isSaving:z.isPending})}),n&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(ct,{isOpen:n,onClose:()=>l(!1),columns:d?.columns||Ne.filter(a=>!ve.includes(a)).map(a=>({name:a,visible:!0})),onSave:be,isSaving:S.isPending})}),m.isOpen&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(ot,{isOpen:m.isOpen,onClose:()=>N({isOpen:!1,rowIndex:-1,value:"",name:""}),initialValue:m.value,onSave:de,influencerName:m.name})}),T&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(dt,{payload:o,isOpen:T,onClose:()=>Y(!1)})}),le&&e.jsx(ht,{ids:X.map(a=>String(a.Ïù∏Ïä§ÌÉÄID||"")).filter(Boolean),onClose:()=>t(!1)})]})}function ht({ids:g,onClose:h}){const[k,u]=s.useState(!1),p=g.join(`
`);s.useEffect(()=>{const C=S=>{S.key==="Escape"&&h()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[h]);const d=()=>{navigator.clipboard.writeText(p).then(()=>{u(!0),setTimeout(()=>u(!1),2e3)})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/50",onClick:h}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-[9999] w-[400px] max-h-[70vh] bg-admin-bg border border-admin-border rounded-lg flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-admin-border",children:[e.jsxs("h2",{className:"text-white font-semibold text-sm",children:["ID Ï∂îÏ∂ú (",g.length,"Í∞ú)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{size:"sm",variant:"outline",onClick:d,className:"bg-transparent border-admin-border text-white hover:bg-admin-card text-xs",children:k?"Î≥µÏÇ¨Îê®!":"Î≥µÏÇ¨"}),e.jsx(U,{size:"icon-sm",variant:"ghost",onClick:h,className:"text-admin-text hover:text-white hover:bg-admin-card",children:e.jsx("span",{className:"text-lg leading-none",children:"√ó"})})]})]}),e.jsx("textarea",{readOnly:!0,value:p,className:"flex-1 min-h-[200px] max-h-[50vh] p-4 bg-transparent text-white text-[13px] font-mono leading-relaxed resize-none focus:outline-none"})]})]})}export{vt as default};
