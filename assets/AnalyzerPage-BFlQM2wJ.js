import{r as o,j as e}from"./index-hQ7EUUYS.js";const N="https://chrome-ext-api.dev-joongi.workers.dev";function w(){const[t,n]=o.useState(null);return o.useEffect(()=>{try{const i=window.location.hash.slice(1);if(!i)return;const s=decodeURIComponent(i),a=JSON.parse(s);a.username&&a.profile&&(n(a),history.replaceState(null,"",window.location.pathname))}catch{}},[]),t}function S(){const[t,n]=o.useState(null),[i,s]=o.useState(!1),[a,l]=o.useState(null),h=o.useCallback(async(r,u)=>{if(!r.trim()){l("ë°”ì´ì˜¤ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤");return}s(!0),l(null);try{const f=`ì¸ìŠ¤íƒ€ê·¸ë¨ ì¸í”Œë£¨ì–¸ì„œì˜ ë°”ì´ì˜¤(ì„¤ëª…ë€)ë¥¼ ë¶„ì„í•˜ì—¬ ì¹´í…Œê³ ë¦¬ë¥¼ ë¶„ë¥˜í•´ì£¼ì„¸ìš”.

ë°”ì´ì˜¤: "${r.replace(/[\n\r]+/g," ").replace(/"/g,"'").substring(0,500)}"
ê³„ì •ëª…: ${u}

ë¶„ë¥˜ ê¸°ì¤€:
1. ëŒ€ë¶„ë¥˜: í•´ë‹¹ ê³„ì •ì˜ ê°€ì¥ í° ì‚°ì—…êµ° ë˜ëŠ” ë¼ì´í”„ìŠ¤íƒ€ì¼ ì˜ì—­
2. ì¤‘ë¶„ë¥˜: ëŒ€ë¶„ë¥˜ ì•ˆì—ì„œ ë” êµ¬ì²´ì ì¸ íƒ€ê²Ÿì´ë‚˜ ì½˜í…ì¸ ì˜ ì„±ê²©

ê·œì¹™:
- ëŒ€ë¶„ë¥˜ëŠ” ë°˜ë“œì‹œ 1ê°œë§Œ ì„ íƒ
- ì¤‘ë¶„ë¥˜ëŠ” 1~3ê°œ ì„ íƒ ê°€ëŠ¥
- ì§§ê³  ëª…í™•í•œ í•œê¸€ í‚¤ì›Œë“œë¡œ ì‘ì„± (2~4ê¸€ì)
- ë°”ì´ì˜¤ì—ì„œ ëª…í™•íˆ íŒŒì•…ë˜ëŠ” ê²ƒë§Œ ë¶„ë¥˜

ë°˜ë“œì‹œ ì•„ë˜ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”:
{"ëŒ€": "í‚¤ì›Œë“œ", "ì¤‘": ["í‚¤ì›Œë“œ1", "í‚¤ì›Œë“œ2"]}`,d=await fetch(N+"/api/groq",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"user",content:f}],temperature:.3,max_tokens:150})});if(!d.ok)throw new Error(`Groq API ì˜¤ë¥˜ (${d.status})`);const g=(await d.json()).choices?.[0]?.message?.content?.trim();if(!g)throw new Error("LLM ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤");const j=g.match(/\{[\s\S]*\}/);if(!j)throw new Error("JSON í˜•ì‹ ì‘ë‹µ ì—†ìŒ");const p=JSON.parse(j[0]),v={ëŒ€:p.ëŒ€||"",ì¤‘:Array.isArray(p.ì¤‘)?p.ì¤‘:[]};n(v)}catch(c){l(c instanceof Error?c.message:"ë¶„ë¥˜ ì‹¤íŒ¨")}finally{s(!1)}},[]);return{category:t,isClassifying:i,error:a,classify:h,setCategory:n}}function y(){const[t,n]=o.useState(!1),i=o.useCallback(async s=>{try{await navigator.clipboard.writeText(s),n(!0),setTimeout(()=>n(!1),2e3)}catch{const a=document.createElement("textarea");a.value=s,a.style.position="fixed",a.style.left="-9999px",document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),n(!0),setTimeout(()=>n(!1),2e3)}},[]);return{copied:t,copy:i}}function C(t,n){const i=n||{ëŒ€:"",ì¤‘:[]},s=new Date().toISOString().slice(0,10);return[t.username,t.profile.displayName||"",(t.profile.bio||"").replace(/\n/g," "),t.profile.externalLink||"",t.profile.profileLink,t.profile.followers,t.stats.avgViews,t.stats.maxViews,i.ëŒ€||"",(i.ì¤‘||[]).join(", "),t.stats.avgLikes||0,t.stats.maxLikes||0,t.stats.avgComments||0,t.stats.maxComments||0,t.stats.lastPostDate||"",s].join("	")}function k(){const[t,n]=o.useState(!1),[i,s]=o.useState(!1),[a,l]=o.useState(null),h=o.useCallback(async(r,u)=>{n(!0),l(null);try{const c=u||{ëŒ€:"",ì¤‘:[]},f=new Date().toISOString().slice(0,10),d=[r.username,r.profile.displayName||"",(r.profile.bio||"").replace(/\n/g," "),r.profile.externalLink||"",r.profile.profileLink,String(r.profile.followers),String(r.stats.avgViews),String(r.stats.maxViews),c.ëŒ€||"",(c.ì¤‘||[]).join(", "),String(r.stats.avgLikes||0),String(r.stats.maxLikes||0),String(r.stats.avgComments||0),String(r.stats.maxComments||0),r.stats.lastPostDate||"",f],b=await fetch(N+"/api/sheets/append?range="+encodeURIComponent("C:R"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({values:[d]})});if(!b.ok)throw new Error(`Sheets ì €ì¥ ì˜¤ë¥˜ (${b.status})`);s(!0),setTimeout(()=>s(!1),3e3)}catch(c){l(c instanceof Error?c.message:"ì €ì¥ ì‹¤íŒ¨")}finally{n(!1)}},[]);return{isSaving:t,saved:i,error:a,save:h}}function m(t){return t?Number(t).toLocaleString("ko-KR"):"0"}function L({profile:t}){return e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-admin-border flex items-center justify-center text-lg",children:"@"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-white font-semibold",children:["@",t.username]}),t.displayName&&e.jsx("p",{className:"text-admin-text text-sm",children:t.displayName})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-admin-text",children:"íŒ”ë¡œì›Œ"}),e.jsx("span",{className:"text-white ml-2 font-semibold",children:m(t.followers)})]}),t.externalLink&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-admin-text",children:"ì™¸ë¶€ë§í¬"}),e.jsx("a",{href:t.externalLink,target:"_blank",rel:"noopener noreferrer",className:"text-admin-accent ml-2 text-xs break-all",children:t.externalLink})]})]}),t.bio&&e.jsx("p",{className:"mt-3 text-sm text-admin-text whitespace-pre-wrap",children:t.bio})]})}function P({stats:t,feedPosts:n,reels:i}){const s=n.filter(l=>!l.isPinned&&l.isDeal),a=i.filter(l=>!l.isPinned);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-white font-semibold text-sm mb-3",children:["í”¼ë“œ í†µê³„ (ê³µêµ¬ ",s.length,"ê°œ)"]}),s.length>0?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsx(x,{label:"í‰ê·  ì¢‹ì•„ìš”",value:m(t.avgLikes)}),e.jsx(x,{label:"ìµœëŒ€ ì¢‹ì•„ìš”",value:m(t.maxLikes)}),e.jsx(x,{label:"í‰ê·  ëŒ“ê¸€",value:m(t.avgComments)}),e.jsx(x,{label:"ìµœëŒ€ ëŒ“ê¸€",value:m(t.maxComments)})]}):e.jsx("p",{className:"text-admin-text text-sm",children:"ê³µêµ¬ ê²Œì‹œë¬¼ ì—†ìŒ"}),t.lastPostDate&&e.jsxs("p",{className:"text-admin-text text-xs mt-2",children:["ìµœê·¼ ê²Œì‹œë¬¼: ",t.lastPostDate]})]}),e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-white font-semibold text-sm mb-3",children:["ë¦´ìŠ¤ í†µê³„ (",a.length,"ê°œ)"]}),a.length>0?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsx(x,{label:"í‰ê·  ì¡°íšŒìˆ˜",value:m(t.avgViews)}),e.jsx(x,{label:"ìµœëŒ€ ì¡°íšŒìˆ˜",value:m(t.maxViews)})]}):e.jsx("p",{className:"text-admin-text text-sm",children:"ë¦´ìŠ¤ ì—†ìŒ"})]})]})}function x({label:t,value:n}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-admin-text text-xs",children:t}),e.jsx("p",{className:"text-white font-semibold",children:n})]})}function E({payload:t}){const{copied:n,copy:i}=y(),{category:s,isClassifying:a,error:l,classify:h}=S(),{isSaving:r,saved:u,error:c,save:f}=k(),d=()=>{i(C(t,s))},b=()=>{h(t.profile.bio,t.username)},g=()=>{f(t,s)};return e.jsxs("div",{className:"space-y-3",children:[s&&e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-admin-text mb-1",children:"AI ë¶„ë¥˜"}),e.jsxs("p",{className:"text-white text-sm",children:[e.jsx("span",{className:"text-admin-accent font-semibold",children:s.ëŒ€}),s.ì¤‘.length>0&&e.jsx("span",{className:"text-admin-text ml-2",children:s.ì¤‘.join(", ")})]})]}),l&&e.jsx("p",{className:"text-red-400 text-xs",children:l}),c&&e.jsx("p",{className:"text-red-400 text-xs",children:c}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:b,disabled:a,className:"flex-1 py-3 rounded-lg text-sm font-semibold bg-admin-card border border-admin-border text-white active:bg-admin-border disabled:opacity-50 min-h-[44px]",children:a?"ë¶„ë¥˜ ì¤‘...":"ë¶„ë¥˜"}),e.jsx("button",{onClick:d,className:"flex-1 py-3 rounded-lg text-sm font-semibold bg-admin-accent text-black active:opacity-80 min-h-[44px]",children:n?"ë³µì‚¬ë¨!":"ë³µì‚¬í•˜ê¸°"}),e.jsx("button",{onClick:g,disabled:r,className:"flex-1 py-3 rounded-lg text-sm font-semibold bg-admin-card border border-admin-border text-white active:bg-admin-border disabled:opacity-50 min-h-[44px]",children:r?"ì €ì¥ ì¤‘...":u?"âœ… ì €ì¥ë¨!":"ğŸ“Š ì‹œíŠ¸ì €ì¥"})]})]})}function O(){const t=w();return t?e.jsxs("div",{className:"min-h-screen bg-admin-bg text-white",children:[e.jsx("header",{className:"p-4 border-b border-admin-border",children:e.jsxs("div",{className:"max-w-lg mx-auto flex items-center justify-between",children:[e.jsx("h1",{className:"text-admin-accent text-xs font-semibold tracking-widest font-admin-mono",children:"IG ANALYZER"}),e.jsx("a",{href:"/analyzer/setup",className:"text-xs text-admin-text",children:"ì„¤ì •"})]})}),e.jsxs("main",{className:"max-w-lg mx-auto p-4 space-y-4 pb-8",children:[e.jsx(L,{profile:t.profile}),e.jsx(P,{stats:t.stats,feedPosts:t.feedPosts,reels:t.reels}),e.jsx(E,{payload:t})]})]}):e.jsxs("div",{className:"min-h-screen bg-admin-bg text-white flex flex-col items-center justify-center p-6",children:[e.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Instagram ì¸í”Œë£¨ì–¸ì„œ ë¶„ì„ê¸°"}),e.jsx("p",{className:"text-admin-text text-center text-sm mb-6",children:"ë¶ë§ˆí´ë¦¿ìœ¼ë¡œ Instagramì—ì„œ ë¶„ì„í•œ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."}),e.jsx("a",{href:"/analyzer/setup",className:"px-6 py-3 bg-admin-accent text-black rounded-lg font-semibold text-sm",children:"ë¶ë§ˆí´ë¦¿ ì„¤ì •í•˜ê¸°"})]})}export{O as default};
