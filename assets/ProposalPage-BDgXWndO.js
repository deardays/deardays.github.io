const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InfluencerSelectModal-C_Rar3JK.js","assets/index-kvcITcEx.js","assets/react-vendor-9l3RvKiN.js","assets/framer-motion-6E75tBg3.js","assets/SortPanel-CCg77oLu.js","assets/tanstack-query-BtejbdqV.js","assets/dialog-CRjbffcy.js","assets/MemoEditModal-og1epeUC.js","assets/ProductBrowser-gNR0aUhP.js","assets/useProductData-BSaB2ruT.js","assets/EmailGenerator-DmpiMjRh.js","assets/copy-Ck-R7ZBU.js","assets/jspdf.es.min-_bPPwl2i.js","assets/index-DFGoSxIl.js","assets/index-BMnKITdA.css"])))=>i.map(i=>d[i]);
import{_}from"./index-DFGoSxIl.js";import{j as e}from"./framer-motion-6E75tBg3.js";import{r as n,u as G}from"./react-vendor-9l3RvKiN.js";import{c as H,t as S}from"./index-kvcITcEx.js";import{B as D,X as W,I as g,S as q,P as X,q as K,u as J,f as F}from"./SortPanel-CCg77oLu.js";import{M as Q,m as Z}from"./InfluencerSelectModal-C_Rar3JK.js";import"./tanstack-query-BtejbdqV.js";import"./dialog-CRjbffcy.js";import"./MemoEditModal-og1epeUC.js";const ee=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],$=H("file-down",ee);function se(){const a=()=>{const o=new Date,r=o.getFullYear(),m=String(o.getMonth()+1).padStart(2,"0");return`${r}.${m}`},[s,i]=n.useState({brandName:"",brandDescription:"",productName:"",productDescription:"",campaignGoal:"",campaignPeriod:"",budget:"",influencers:[],notes:""}),[t,h]=n.useState(a()),N=n.useCallback((o,r)=>{i(m=>({...m,[o]:r}))},[]),v=n.useCallback(()=>{const o={id:crypto.randomUUID(),name:"",followers:"",category:"",profileUrl:"",avgViews:"",engagementRate:"",maxComments:"",commentActivity:""};i(r=>({...r,influencers:[...r.influencers,o]}))},[]),x=n.useCallback(o=>{i(r=>({...r,influencers:r.influencers.filter(m=>m.id!==o)}))},[]),w=n.useCallback((o,r)=>{i(m=>({...m,influencers:m.influencers.map(b=>b.id===o?{...b,...r}:b)}))},[]),l=n.useCallback(o=>{i(r=>({...r,...o}))},[]),c=n.useCallback(()=>{i({brandName:"",brandDescription:"",productName:"",productDescription:"",campaignGoal:"",campaignPeriod:"",budget:"",influencers:[],notes:""}),h(a())},[]);return{formData:s,proposalDate:t,setProposalDate:h,updateField:N,addInfluencer:v,removeInfluencer:x,updateInfluencer:w,loadProposalData:l,resetForm:c}}function ae({influencer:a,onUpdate:s,onRemove:i}){return e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded p-4 relative",children:[e.jsx(D,{variant:"ghost",size:"sm",onClick:i,className:"absolute top-2 right-2 h-6 w-6 p-0 hover:bg-admin-error/20",children:e.jsx(W,{className:"h-4 w-4 text-admin-error"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"이름"}),e.jsx(g,{value:a.name,onChange:t=>s({name:t.target.value}),placeholder:"인플루언서 이름",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"팔로워"}),e.jsx(g,{value:a.followers,onChange:t=>s({followers:t.target.value}),placeholder:"예: 50만",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"카테고리"}),e.jsx(g,{value:a.category,onChange:t=>s({category:t.target.value}),placeholder:"예: 뷰티",className:"bg-admin-bg border-admin-border text-sm h-8"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"평균 조회수"}),e.jsx(g,{value:a.avgViews,onChange:t=>s({avgViews:t.target.value}),placeholder:"예: 10만",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"참여율"}),e.jsx(g,{value:a.engagementRate,onChange:t=>s({engagementRate:t.target.value}),placeholder:"예: 8.5%",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"프로필 URL"}),e.jsx(g,{value:a.profileUrl,onChange:t=>s({profileUrl:t.target.value}),placeholder:"https://...",className:"bg-admin-bg border-admin-border text-sm h-8"})]})]})]})}const re=n.memo(function({formData:s,proposalDate:i,onDateChange:t,onFieldUpdate:h,onAddInfluencer:N,onRemoveInfluencer:v,onUpdateInfluencer:x,onOpenInfluencerBrowser:w,onOpenProductBrowser:l,onSavePDF:c,onGenerateEmail:o}){return e.jsx("div",{className:"w-full lg:w-[400px] bg-admin-card border-r border-admin-border lg:overflow-y-auto lg:h-screen",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white mb-2",children:"제안서 작성"}),e.jsx("p",{className:"text-xs text-admin-text",children:"제품 정보와 인플루언서를 선택하세요"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:l,className:"w-full border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"제품 불러오기"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"제품 정보"}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-admin-text mb-1 block",children:["제품명 ",e.jsx("span",{className:"text-admin-error",children:"*"})]}),e.jsx(g,{value:s.productName,onChange:r=>h("productName",r.target.value),placeholder:"제품명을 입력하세요",className:"bg-admin-bg border-admin-border text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"제품 상세"}),e.jsx("textarea",{value:s.productDescription,onChange:r=>h("productDescription",r.target.value),placeholder:"제품 설명을 입력하세요",className:"w-full bg-admin-bg border border-admin-border rounded px-3 py-2 text-sm text-white resize-none focus:outline-none focus:ring-1 focus:ring-admin-accent",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"회사명"}),e.jsx(g,{value:s.brandName,onChange:r=>h("brandName",r.target.value),placeholder:"브랜드명을 입력하세요",className:"bg-admin-bg border-admin-border text-sm"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"인플루언서"}),e.jsxs(D,{variant:"outline",size:"sm",onClick:w,className:"border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"찾기"]})]}),e.jsx("div",{className:"space-y-2",children:s.influencers.map(r=>e.jsx(ae,{influencer:r,onUpdate:m=>x(r.id,m),onRemove:()=>v(r.id)},r.id))}),e.jsxs(D,{variant:"outline",size:"sm",onClick:N,className:"w-full border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),"인플루언서 추가"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"기타 정보"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"제안일"}),e.jsx(g,{value:i,onChange:r=>t(r.target.value),placeholder:"YYYY.MM",className:"bg-admin-bg border-admin-border text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"메모"}),e.jsx("textarea",{value:s.notes,onChange:r=>h("notes",r.target.value),placeholder:"추가 메모",className:"w-full bg-admin-bg border border-admin-border rounded px-3 py-2 text-sm text-white resize-none focus:outline-none focus:ring-1 focus:ring-admin-accent",rows:3})]})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-admin-border",children:[e.jsxs(D,{onClick:c,className:"w-full bg-admin-accent hover:bg-admin-accent/90 text-admin-bg text-sm",disabled:!s.productName,children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"PDF 저장"]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:o,className:"w-full border-admin-border hover:bg-admin-bg text-xs",disabled:!s.productName,children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),"이메일"]})]})]})})});function ne({children:a,maxSize:s=13}){const i=n.useRef(null);return n.useEffect(()=>{const t=i.current;if(!t)return;t.style.fontSize=`${s}px`;const h=t.clientWidth/t.scrollWidth;if(h<1){const N=Math.max(7,Math.floor(s*h*2)/2);t.style.fontSize=`${N}px`}},[a,s]),e.jsx("h5",{ref:i,style:{whiteSpace:"nowrap",fontSize:`${s}px`},children:a})}function te(a){if(!a)return"";const s=a.match(/instagram\.com\/([^/?]+)/);if(s)return s[1];if(!a.includes("/"))return a;const i=a.replace(/\/+$/,"").split("/");return i[i.length-1]||a}const le=n.memo(function({data:s,proposalDate:i}){const t=n.useRef(null),h=n.useRef(null),[N,v]=n.useState(1),x=n.useCallback(()=>{const l=t.current,c=h.current;!l||!c||(c.style.transform="none",requestAnimationFrame(()=>{const o=c.scrollWidth,r=c.scrollHeight,m=window.innerWidth<1024,b=m?0:40,P=l.clientWidth-b;let j;if(m)j=Math.min(P/o,1);else{const E=l.clientHeight-40,I=P/o,O=E/r;j=Math.min(I,O,1)}v(j),c.style.transform=`scale(${j})`,c.style.transformOrigin=m?"top left":"top center",m?l.style.height=`${r*j}px`:l.style.height=""}))},[]);n.useEffect(()=>{x();const l=t.current;if(!l)return;const c=new ResizeObserver(x);return c.observe(l),()=>c.disconnect()},[x]);const w=n.useMemo(()=>`${s.influencers.length}-${!!s.productName}-${!!s.productDescription}-${!!s.brandName}`,[s.influencers.length,s.productName,s.productDescription,s.brandName]);return n.useEffect(()=>{x()},[w,x]),e.jsx("div",{className:"proposal-preview-container",ref:t,children:e.jsxs("div",{className:"proposal-document",id:"proposal-preview",ref:h,style:{transformOrigin:"top center",transform:`scale(${N})`},children:[e.jsx("div",{className:"top-bar"}),e.jsx("div",{className:"corner-bracket top-left"}),e.jsx("div",{className:"corner-bracket top-right"}),e.jsx("div",{className:"corner-bracket bottom-right"}),e.jsxs("div",{className:"proposal-content",children:[e.jsxs("div",{className:"proposal-header",children:[e.jsx("span",{children:"DEARDAYS AGENCY"}),e.jsx("span",{children:i})]}),e.jsxs("div",{className:"title-section",children:[e.jsx("div",{className:"accent-line"}),e.jsx("h1",{children:"인플루언서 공동구매"}),e.jsx("h2",{children:"협업 제안서"}),e.jsx("p",{className:"subtitle",children:"INFLUENCER COLLABORATION PROPOSAL"}),e.jsx("div",{className:"divider"})]}),s.productName&&e.jsx("div",{className:"product-card",children:e.jsxs("div",{className:"product-info",children:[e.jsx("p",{className:"label",children:"PRODUCT"}),e.jsx("h3",{children:s.productName}),s.productDescription&&e.jsx("p",{className:"detail",children:s.productDescription}),s.brandName&&e.jsx("p",{className:"company",children:s.brandName})]})}),s.influencers.length>0&&e.jsxs("div",{className:"influencer-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"line"}),e.jsx("p",{className:"eng",children:"RECOMMENDED INFLUENCERS"}),e.jsx("h4",{children:"추천 인플루언서"})]}),e.jsx("div",{className:"influencer-cards",children:s.influencers.map(l=>{const c=l.profileUrl?te(l.profileUrl):"";return e.jsxs("div",{className:"influencer-card",children:[c&&e.jsx("img",{className:"avatar",src:`${K}/instagram-avatar/${c}`,alt:l.name||"",onError:o=>{o.target.style.display="none"}}),e.jsx(ne,{children:l.name||"이름 없음"}),e.jsxs("p",{className:"handle",children:[c&&e.jsxs(e.Fragment,{children:["@",c]}),c&&l.followers?" · ":null,l.followers&&e.jsx("span",{className:"followers",children:l.followers})]}),l.category&&e.jsx("p",{className:"category",children:l.category})]},l.id)})}),e.jsx("p",{className:"influencer-note",children:"* 비슷한 규모의 다른 인플루언서와의 협업도 가능합니다"})]}),e.jsxs("div",{className:"promise-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"line"}),e.jsx("p",{className:"eng",children:"OUR COMMITMENT"}),e.jsx("h4",{children:"디어데이즈의 약속"})]}),e.jsxs("div",{className:"promise-list",children:[e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"1."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"검증된 인플루언서 매칭"}),e.jsx("span",{className:"promise-desc",children:"데이터 기반으로 제품과 핏이 맞는 인플루언서를 선별하고, 캠페인 전 과정을 밀착 관리"})]})]}),e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"2."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"맞춤 콘텐츠 기획"}),e.jsx("span",{className:"promise-desc",children:"공구 오픈 전, 인플루언서의 일상 속 제품 사용 피드·릴스를 먼저 선보여 자연스러운 신뢰를 형성"})]})]}),e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"3."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"브랜드사 부담 최소화"}),e.jsx("span",{className:"promise-desc",children:"기획·섭외·일정 조율·콘텐츠 검수까지 원스톱으로 진행하여 브랜드사는 제품 준비에만 집중"})]})]})]})]}),e.jsxs("div",{className:"agency-section",children:[e.jsxs("div",{className:"agency-header",children:[e.jsx("h4",{children:"DEARDAYS"}),e.jsx("span",{children:"공동구매 전문 에이전시"})]}),e.jsxs("div",{className:"stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"400+"}),e.jsx("p",{className:"label",children:"누적 공동구매 진행"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"200+"}),e.jsx("p",{className:"label",children:"협력 브랜드"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"300+"}),e.jsx("p",{className:"label",children:"검증된 인플루언서"})]}),e.jsx("div",{className:"stat website",children:e.jsx("p",{className:"value",children:"deardays.kr"})})]})]}),e.jsxs("div",{className:"contact-card",children:[e.jsxs("div",{className:"contact-info",children:[e.jsx("p",{className:"label",children:"CONTACT"}),e.jsxs("div",{className:"contact-name-row",children:[e.jsx("h5",{children:"정준기 이사"}),e.jsx("span",{className:"contact-phone",children:"010.4343.3685"}),e.jsx("span",{className:"contact-divider",children:"|"}),e.jsx("span",{className:"contact-email",children:"deardays.agency@gmail.com"})]}),e.jsx("p",{className:"company",children:"디어데이즈 공동구매 에이전시"})]}),e.jsxs("div",{className:"contact-qr",children:[e.jsx("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https%3A%2F%2Fopen.kakao.com%2Fo%2Fs9XdCNdi&bgcolor=26262f&color=faf8f5",alt:"카톡 1:1 문의",className:"qr-image"}),e.jsx("span",{className:"qr-label",children:"카톡 1:1 문의"})]})]}),e.jsx("div",{className:"proposal-footer",children:e.jsx("p",{children:"© 2026 DEARDAYS AGENCY | INFLUENCER COLLABORATION PROPOSAL"})})]})]})})}),ce=n.lazy(()=>_(()=>import("./InfluencerSelectModal-C_Rar3JK.js").then(a=>a.a),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(a=>({default:a.InfluencerSelectModal}))),oe=n.lazy(()=>_(()=>import("./ProductBrowser-gNR0aUhP.js"),__vite__mapDeps([8,3,2,4,1,5,6,9])).then(a=>({default:a.ProductBrowser}))),ie=n.lazy(()=>_(()=>import("./EmailGenerator-DmpiMjRh.js"),__vite__mapDeps([10,3,2,4,1,5,6,11])).then(a=>({default:a.EmailGenerator})));function je(){const{formData:a,proposalDate:s,setProposalDate:i,updateField:t,addInfluencer:h,removeInfluencer:N,updateInfluencer:v,loadProposalData:x}=se(),{data:w}=J(),l=G();n.useEffect(()=>{const d=l.state;d&&(x({...d.productName&&{productName:d.productName},...d.brandName&&{brandName:d.brandName},...d.influencers&&{influencers:d.influencers}}),window.history.replaceState({},""))},[]);const c=n.useDeferredValue(a),o=n.useMemo(()=>new Set(a.influencers.map(d=>d.profileUrl?.match(/instagram\.com\/([^/?]+)/)?.[1]||"").filter(Boolean)),[a.influencers]),[r,m]=n.useState(!1),[b,P]=n.useState(!1),[j,E]=n.useState(!1),I=d=>{const C=w?.data||[],u=d.influencerIds.map(y=>{const p=C.find(f=>String(f.인스타ID||"")===y);return p?{id:crypto.randomUUID(),name:String(p["인스타 이름"]||y),followers:F(String(p.팔로워||"")),category:String(p["카테고리(대)"]||""),profileUrl:String(p["프로필 링크"]||`https://instagram.com/${y}`),avgViews:F(String(p["최근 10 평균 릴스 조회수"]||"")),engagementRate:"",maxComments:F(String(p["공구 최대댓글수"]||"")),commentActivity:(()=>{const f=String(p.댓글활동여부||"").trim().toUpperCase();return f==="Y"||f==="O"?"Y":"N"})()}:{id:crypto.randomUUID(),name:y,followers:"",category:"",profileUrl:`https://instagram.com/${y}`,avgViews:"",engagementRate:"",maxComments:"",commentActivity:""}});x({productName:d.productName,brandName:d.brandName,influencers:u})},O=d=>{const C=d.map(Z);x({influencers:[...a.influencers,...C]})},T=async()=>{if(!a.productName){S.error("제품명을 입력해주세요");return}try{const d=(await _(async()=>{const{default:A}=await import("./html2canvas.esm-DXEQVQnt.js");return{default:A}},[])).default,C=(await _(async()=>{const{default:A}=await import("./jspdf.es.min-_bPPwl2i.js").then(V=>V.j);return{default:A}},__vite__mapDeps([12,13,3,2,14]))).default,u=document.getElementById("proposal-preview");if(!u)throw new Error("Preview element not found");S.info("PDF 생성 중...");const y=u.style.transform,p=u.style.transformOrigin;u.style.transform="none",u.style.transformOrigin="";const f=await d(u,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#16161c"});u.style.transform=y,u.style.transformOrigin=p;const k=210,B=297,M=f.height*k/f.width,L=Math.max(M,B),R=new C("p","mm",[k,L]);R.setFillColor(22,22,28),R.rect(0,0,k,L,"F");const U=f.toDataURL("image/png");R.addImage(U,"PNG",0,0,k,M);const Y=`제안서_${a.brandName||a.productName}_${s.replace(/\./g,"")}.pdf`;R.save(Y),S.success("PDF가 저장되었습니다")}catch(d){console.error("Failed to save PDF:",d),S.error("PDF 저장에 실패했습니다")}},z=()=>{if(!a.productName){S.error("제품명을 입력해주세요");return}E(!0)};return e.jsxs("div",{className:"flex flex-col lg:flex-row min-h-screen lg:h-screen bg-admin-bg",children:[e.jsx(re,{formData:a,proposalDate:s,onDateChange:i,onFieldUpdate:t,onAddInfluencer:h,onRemoveInfluencer:N,onUpdateInfluencer:v,onOpenInfluencerBrowser:()=>m(!0),onOpenProductBrowser:()=>P(!0),onSavePDF:T,onGenerateEmail:z}),e.jsx("div",{className:"flex-1 lg:overflow-hidden",children:e.jsx(le,{data:c,proposalDate:s})}),r&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(ce,{open:r,onClose:()=>m(!1),onConfirm:O,disabledIds:o})}),b&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(oe,{open:b,onClose:()=>P(!1),onLoadProduct:I})}),j&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(ie,{open:j,onClose:()=>E(!1),data:a})})]})}export{je as default};
