import{r}from"./react-vendor-9l3RvKiN.js";const w="https://chrome-ext-api.dev-joongi.workers.dev";function E(){const[e,s]=r.useState(null);return r.useEffect(()=>{try{const n=window.location.hash.slice(1);if(!n)return;const t=decodeURIComponent(n),o=JSON.parse(t);o.username&&o.profile&&(s(o),history.replaceState(null,"",window.location.pathname))}catch{}},[]),e}function R(){const[e,s]=r.useState(null),[n,t]=r.useState(!1),[o,i]=r.useState(null),S=r.useCallback(async(l,d)=>{if(!l.trim()){i("바이오가 비어있습니다");return}t(!0),i(null);try{const u=`인스타그램 인플루언서의 바이오(설명란)를 분석하여 카테고리를 분류해주세요.

바이오: "${l.replace(/[\n\r]+/g," ").replace(/"/g,"'").substring(0,500)}"
계정명: ${d}

분류 기준:
1. 대분류: 해당 계정의 가장 큰 산업군 또는 라이프스타일 영역
2. 중분류: 대분류 안에서 더 구체적인 타겟이나 콘텐츠의 성격

규칙:
- 대분류는 반드시 1개만 선택 (가장 핵심적인 것)
- 중분류는 1~3개 선택 가능
- 짧고 명확한 한글 키워드로 작성 (2~4글자)
- 바이오에서 명확히 파악되는 것만 분류

반드시 아래 JSON 형식으로만 응답하세요. 설명 없이 JSON만 출력:
{"대": "키워드", "중": ["키워드1", "키워드2"]}`,f=await fetch(w+"/api/groq",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"user",content:u}],temperature:.3,max_tokens:150})});if(!f.ok)throw new Error(`Groq API 오류 (${f.status})`);const c=(await f.json()).choices?.[0]?.message?.content,g=typeof c=="string"?c.trim():String(c??"");if(!g)throw new Error("LLM 응답이 비어있습니다");const p=g.match(/\{[\s\S]*\}/);if(!p)throw new Error("JSON 형식 응답 없음");const h=JSON.parse(p[0]),v={대:h.대||"",중:Array.isArray(h.중)?h.중:[]};s(v)}catch(a){i(a instanceof Error?a.message:"분류 실패")}finally{t(!1)}},[]);return{category:e,isClassifying:n,error:o,classify:S,setCategory:s}}function T(){const[e,s]=r.useState(!1),n=r.useCallback(async t=>{try{await navigator.clipboard.writeText(t),s(!0),setTimeout(()=>s(!1),2e3)}catch{const o=document.createElement("textarea");o.value=t,o.style.position="fixed",o.style.left="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),s(!0),setTimeout(()=>s(!1),2e3)}},[]);return{copied:e,copy:n}}function L(e,s){const n=s||{대:"",중:[]},t=new Date().toISOString().slice(0,10);return[e.username,e.profile.displayName||"",(e.profile.bio||"").replace(/\n/g," "),e.profile.externalLink||"",e.profile.profileLink,e.profile.followers,e.stats.avgViews,e.stats.maxViews,n.대||"",(n.중||[]).join(", "),e.stats.avgLikes||0,e.stats.maxLikes||0,e.stats.avgComments||0,e.stats.maxComments||0,e.stats.lastPostDate||"",t].join("	")}async function C(e){const s=await fetch(w+"/api/sheets/values?range="+encodeURIComponent(e),{headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("시트 읽기 실패");return s.json()}async function x(e){const n=(await C("C:C")).values||[];for(let t=0;t<n.length;t++)if(n[t][0]===e)return{rowIndex:t+1,columnData:n};return{rowIndex:-1,columnData:n}}function y(e,s){const n=[];for(let t=0;t<s.length;t++){const o=s[t],i=t<e.length?e[t]:"";o===""||o==="0"||o==null?n.push(i):n.push(o)}return n}function b(e,s){const n=s||{대:"",중:[]},t=new Date().toISOString().slice(0,10);return[e.username,e.profile.displayName||"",(e.profile.bio||"").replace(/\n/g," "),e.profile.externalLink||"",e.profile.profileLink,String(e.profile.followers),String(e.stats.avgViews),String(e.stats.maxViews),n.대||"",(n.중||[]).join(", "),String(e.stats.avgLikes||0),String(e.stats.maxLikes||0),String(e.stats.avgComments||0),String(e.stats.maxComments||0),e.stats.lastPostDate||"",t]}function N(){const[e,s]=r.useState(!1),[n,t]=r.useState(!1),[o,i]=r.useState(null),S=r.useCallback(async(l,d)=>{s(!0),i(null);try{const a=b(l,d),{rowIndex:u,columnData:f}=await x(l.username);if(u>0){const m="C"+u+":R"+u,g=(await C(m)).values?.[0]||[],p=y(g,a);if(!(await fetch(w+"/api/sheets/values?range="+encodeURIComponent(m),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({values:[p]})})).ok)throw new Error("시트 업데이트 실패")}else{const m=(f.length||1)+4,c=[String(m),"FALSE",...a];if(!(await fetch(w+"/api/sheets/append?range="+encodeURIComponent("A:R"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({values:[c]})})).ok)throw new Error("시트 추가 실패")}t(!0),setTimeout(()=>t(!1),3e3)}catch(a){i(a instanceof Error?a.message:"저장 실패")}finally{s(!1)}},[]);return{isSaving:e,saved:n,error:o,save:S}}function O(e){return e?Number(e).toLocaleString("ko-KR"):"0"}export{R as a,N as b,L as c,E as d,O as f,T as u};
