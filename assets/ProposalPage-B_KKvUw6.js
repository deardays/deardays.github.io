const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-Cy7lqWaa.js","assets/index-DgTccGhv.js","assets/index-jmsMnL4Y.css"])))=>i.map(i=>d[i]);
import{r as d,j as e,u as X,_ as L}from"./index-DgTccGhv.js";import{c as K,B as y,X as Q,I as v,S as T,v as J,h as B,i as z,j as U,k as Y,t as C,d as Z,u as ee,f as O}from"./useInfluencerData-sXWIHYQZ.js";import{P as se,M as ae,u as re,I as te,m as ne}from"./useProductData-CCS3O8ia.js";import{C as ce}from"./copy-GgjduWAs.js";import"./useQuery-CcoIhEhR.js";const le=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],M=K("file-down",le);function oe(){const a=()=>{const s=new Date,o=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0");return`${o}.${i}`},[r,l]=d.useState({brandName:"",brandDescription:"",productName:"",productDescription:"",campaignGoal:"",campaignPeriod:"",budget:"",influencers:[],notes:""}),[n,u]=d.useState(a());return{formData:r,proposalDate:n,setProposalDate:u,updateField:(s,o)=>{l(i=>({...i,[s]:o}))},addInfluencer:()=>{const s={id:crypto.randomUUID(),name:"",followers:"",category:"",profileUrl:"",avgViews:"",engagementRate:"",maxComments:"",commentActivity:""};l(o=>({...o,influencers:[...o.influencers,s]}))},removeInfluencer:s=>{l(o=>({...o,influencers:o.influencers.filter(i=>i.id!==s)}))},updateInfluencer:(s,o)=>{l(i=>({...i,influencers:i.influencers.map(b=>b.id===s?{...b,...o}:b)}))},loadProposalData:s=>{l(o=>({...o,...s}))},resetForm:()=>{l({brandName:"",brandDescription:"",productName:"",productDescription:"",campaignGoal:"",campaignPeriod:"",budget:"",influencers:[],notes:""}),u(a())}}}function ie({influencer:a,onUpdate:r,onRemove:l}){return e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded p-4 relative",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:l,className:"absolute top-2 right-2 h-6 w-6 p-0 hover:bg-admin-error/20",children:e.jsx(Q,{className:"h-4 w-4 text-admin-error"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"이름"}),e.jsx(v,{value:a.name,onChange:n=>r({name:n.target.value}),placeholder:"인플루언서 이름",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"팔로워"}),e.jsx(v,{value:a.followers,onChange:n=>r({followers:n.target.value}),placeholder:"예: 50만",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"카테고리"}),e.jsx(v,{value:a.category,onChange:n=>r({category:n.target.value}),placeholder:"예: 뷰티",className:"bg-admin-bg border-admin-border text-sm h-8"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"평균 조회수"}),e.jsx(v,{value:a.avgViews,onChange:n=>r({avgViews:n.target.value}),placeholder:"예: 10만",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"참여율"}),e.jsx(v,{value:a.engagementRate,onChange:n=>r({engagementRate:n.target.value}),placeholder:"예: 8.5%",className:"bg-admin-bg border-admin-border text-sm h-8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"프로필 URL"}),e.jsx(v,{value:a.profileUrl,onChange:n=>r({profileUrl:n.target.value}),placeholder:"https://...",className:"bg-admin-bg border-admin-border text-sm h-8"})]})]})]})}function de({formData:a,proposalDate:r,onDateChange:l,onFieldUpdate:n,onAddInfluencer:u,onRemoveInfluencer:g,onUpdateInfluencer:p,onOpenInfluencerBrowser:x,onOpenProductBrowser:h,onSavePDF:c,onGenerateEmail:t}){return e.jsx("div",{className:"w-full lg:w-[400px] bg-admin-card border-r border-admin-border lg:overflow-y-auto lg:h-screen",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white mb-2",children:"제안서 작성"}),e.jsx("p",{className:"text-xs text-admin-text",children:"제품 정보와 인플루언서를 선택하세요"})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:h,className:"w-full border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"제품 불러오기"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"제품 정보"}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-admin-text mb-1 block",children:["제품명 ",e.jsx("span",{className:"text-admin-error",children:"*"})]}),e.jsx(v,{value:a.productName,onChange:s=>n("productName",s.target.value),placeholder:"제품명을 입력하세요",className:"bg-admin-bg border-admin-border text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"제품 상세"}),e.jsx("textarea",{value:a.productDescription,onChange:s=>n("productDescription",s.target.value),placeholder:"제품 설명을 입력하세요",className:"w-full bg-admin-bg border border-admin-border rounded px-3 py-2 text-sm text-white resize-none focus:outline-none focus:ring-1 focus:ring-admin-accent",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"회사명"}),e.jsx(v,{value:a.brandName,onChange:s=>n("brandName",s.target.value),placeholder:"브랜드명을 입력하세요",className:"bg-admin-bg border-admin-border text-sm"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"인플루언서"}),e.jsxs(y,{variant:"outline",size:"sm",onClick:x,className:"border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"찾기"]})]}),e.jsx("div",{className:"space-y-2",children:a.influencers.map(s=>e.jsx(ie,{influencer:s,onUpdate:o=>p(s.id,o),onRemove:()=>g(s.id)},s.id))}),e.jsxs(y,{variant:"outline",size:"sm",onClick:u,className:"w-full border-admin-border hover:bg-admin-bg text-xs",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"인플루언서 추가"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:"기타 정보"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"제안일"}),e.jsx(v,{value:r,onChange:s=>l(s.target.value),placeholder:"YYYY.MM",className:"bg-admin-bg border-admin-border text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-1 block",children:"메모"}),e.jsx("textarea",{value:a.notes,onChange:s=>n("notes",s.target.value),placeholder:"추가 메모",className:"w-full bg-admin-bg border border-admin-border rounded px-3 py-2 text-sm text-white resize-none focus:outline-none focus:ring-1 focus:ring-admin-accent",rows:3})]})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-admin-border",children:[e.jsxs(y,{onClick:c,className:"w-full bg-admin-accent hover:bg-admin-accent/90 text-admin-bg text-sm",disabled:!a.productName,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"PDF 저장"]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:t,className:"w-full border-admin-border hover:bg-admin-bg text-xs",disabled:!a.productName,children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"이메일"]})]})]})})}function me({children:a,maxSize:r=13}){const l=d.useRef(null);return d.useEffect(()=>{const n=l.current;if(n)for(n.style.fontSize=`${r}px`;n.scrollWidth>n.clientWidth&&parseFloat(n.style.fontSize)>7;)n.style.fontSize=`${parseFloat(n.style.fontSize)-.5}px`},[a,r]),e.jsx("h5",{ref:l,style:{whiteSpace:"nowrap",fontSize:`${r}px`},children:a})}function xe(a){if(!a)return"";const r=a.match(/instagram\.com\/([^/?]+)/);if(r)return r[1];if(!a.includes("/"))return a;const l=a.replace(/\/+$/,"").split("/");return l[l.length-1]||a}const he=d.memo(function({data:r,proposalDate:l}){const n=d.useRef(null),u=d.useRef(null),[g,p]=d.useState(1),x=d.useCallback(()=>{const c=n.current,t=u.current;if(!c||!t)return;t.style.transform="none";const s=t.scrollWidth,o=t.scrollHeight,i=window.innerWidth<1024,b=i?0:40,D=c.clientWidth-b;let N;if(i)N=Math.min(D/s,1);else{const I=c.clientHeight-40,E=D/s,$=I/o;N=Math.min(E,$,1)}p(N),t.style.transform=`scale(${N})`,i?c.style.height=`${o*N}px`:c.style.height=""},[]);d.useEffect(()=>{x();const c=n.current;if(!c)return;const t=new ResizeObserver(x);return t.observe(c),()=>t.disconnect()},[x]);const h=d.useMemo(()=>`${r.influencers.length}-${!!r.productName}-${!!r.productDescription}-${!!r.brandName}`,[r.influencers.length,r.productName,r.productDescription,r.brandName]);return d.useEffect(()=>{x()},[h,x]),e.jsx("div",{className:"proposal-preview-container",ref:n,children:e.jsxs("div",{className:"proposal-document",id:"proposal-preview",ref:u,style:{transformOrigin:"top center",transform:`scale(${g})`},children:[e.jsx("div",{className:"top-bar"}),e.jsx("div",{className:"corner-bracket top-left"}),e.jsx("div",{className:"corner-bracket top-right"}),e.jsx("div",{className:"corner-bracket bottom-right"}),e.jsxs("div",{className:"proposal-content",children:[e.jsxs("div",{className:"proposal-header",children:[e.jsx("span",{children:"DEARDAYS AGENCY"}),e.jsx("span",{children:l})]}),e.jsxs("div",{className:"title-section",children:[e.jsx("div",{className:"accent-line"}),e.jsx("h1",{children:"인플루언서 공동구매"}),e.jsx("h2",{children:"협업 제안서"}),e.jsx("p",{className:"subtitle",children:"INFLUENCER COLLABORATION PROPOSAL"}),e.jsx("div",{className:"divider"})]}),r.productName&&e.jsx("div",{className:"product-card",children:e.jsxs("div",{className:"product-info",children:[e.jsx("p",{className:"label",children:"PRODUCT"}),e.jsx("h3",{children:r.productName}),r.productDescription&&e.jsx("p",{className:"detail",children:r.productDescription}),r.brandName&&e.jsx("p",{className:"company",children:r.brandName})]})}),r.influencers.length>0&&e.jsxs("div",{className:"influencer-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"line"}),e.jsx("p",{className:"eng",children:"RECOMMENDED INFLUENCERS"}),e.jsx("h4",{children:"추천 인플루언서"})]}),e.jsx("div",{className:"influencer-cards",children:r.influencers.map(c=>{const t=c.profileUrl?xe(c.profileUrl):"";return e.jsxs("div",{className:"influencer-card",children:[t&&e.jsx("img",{className:"avatar",src:`${J}/instagram-avatar/${t}`,alt:c.name||"",onError:s=>{s.target.style.display="none"}}),e.jsx(me,{children:c.name||"이름 없음"}),e.jsxs("p",{className:"handle",children:[t&&e.jsxs(e.Fragment,{children:["@",t]}),t&&c.followers&&" · ",c.followers&&e.jsx("span",{className:"followers",children:c.followers})]}),c.category&&e.jsx("p",{className:"category",children:c.category})]},c.id)})}),e.jsx("p",{className:"influencer-note",children:"* 비슷한 규모의 다른 인플루언서와의 협업도 가능합니다"})]}),e.jsxs("div",{className:"promise-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("div",{className:"line"}),e.jsx("p",{className:"eng",children:"OUR COMMITMENT"}),e.jsx("h4",{children:"디어데이즈의 약속"})]}),e.jsxs("div",{className:"promise-list",children:[e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"1."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"검증된 인플루언서 매칭"}),e.jsx("span",{className:"promise-desc",children:"데이터 기반으로 제품과 핏이 맞는 인플루언서를 선별하고, 캠페인 전 과정을 밀착 관리"})]})]}),e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"2."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"맞춤 콘텐츠 기획"}),e.jsx("span",{className:"promise-desc",children:"공구 오픈 전, 인플루언서의 일상 속 제품 사용 피드·릴스를 먼저 선보여 자연스러운 신뢰를 형성"})]})]}),e.jsxs("div",{className:"promise-item",children:[e.jsx("span",{className:"number",children:"3."}),e.jsxs("span",{className:"text",children:[e.jsx("strong",{children:"브랜드사 부담 최소화"}),e.jsx("span",{className:"promise-desc",children:"기획·섭외·일정 조율·콘텐츠 검수까지 원스톱으로 진행하여 브랜드사는 제품 준비에만 집중"})]})]})]})]}),e.jsxs("div",{className:"agency-section",children:[e.jsxs("div",{className:"agency-header",children:[e.jsx("h4",{children:"DEARDAYS"}),e.jsx("span",{children:"공동구매 전문 에이전시"})]}),e.jsxs("div",{className:"stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"400+"}),e.jsx("p",{className:"label",children:"누적 공동구매 진행"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"200+"}),e.jsx("p",{className:"label",children:"협력 브랜드"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("p",{className:"value",children:"300+"}),e.jsx("p",{className:"label",children:"검증된 인플루언서"})]}),e.jsx("div",{className:"stat website",children:e.jsx("p",{className:"value",children:"deardays.kr"})})]})]}),e.jsxs("div",{className:"contact-card",children:[e.jsxs("div",{className:"contact-info",children:[e.jsx("p",{className:"label",children:"CONTACT"}),e.jsxs("div",{className:"contact-name-row",children:[e.jsx("h5",{children:"정준기 이사"}),e.jsx("span",{className:"contact-phone",children:"010.4343.3685"}),e.jsx("span",{className:"contact-divider",children:"|"}),e.jsx("span",{className:"contact-email",children:"deardays.agency@gmail.com"})]}),e.jsx("p",{className:"company",children:"디어데이즈 공동구매 에이전시"})]}),e.jsxs("div",{className:"contact-qr",children:[e.jsx("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https%3A%2F%2Fopen.kakao.com%2Fo%2Fs9XdCNdi&bgcolor=26262f&color=faf8f5",alt:"카톡 1:1 문의",className:"qr-image"}),e.jsx("span",{className:"qr-label",children:"카톡 1:1 문의"})]})]}),e.jsx("div",{className:"proposal-footer",children:e.jsx("p",{children:"© 2026 DEARDAYS AGENCY | INFLUENCER COLLABORATION PROPOSAL"})})]})]})})});function ue({open:a,onClose:r,onLoadProduct:l}){const{data:n,isLoading:u}=re(),g=n?.data||[],[p,x]=d.useState(""),h=d.useMemo(()=>{if(!p.trim())return g;const t=p.toLowerCase();return g.filter(s=>{const o=String(s.제품명||"").toLowerCase(),i=String(s.업체명||"").toLowerCase();return o.includes(t)||i.includes(t)})},[g,p]),c=t=>{const o=String(t["핏한 인플루언서"]||"").split(",").map(i=>i.trim()).filter(Boolean);l({productName:String(t.제품명||""),brandName:String(t.업체명||""),influencerIds:o}),C.success("제품을 불러왔습니다"),r(),x("")};return e.jsx(B,{open:a,onOpenChange:t=>{t||(r(),x(""))},children:e.jsxs(z,{className:"max-w-2xl max-h-[80vh] bg-admin-card border-admin-border text-white",children:[e.jsx(U,{children:e.jsx(Y,{className:"text-white",children:"제품 불러오기"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-admin-text"}),e.jsx(v,{value:p,onChange:t=>x(t.target.value),placeholder:"제품명 또는 업체명으로 검색...",className:"pl-10 bg-admin-bg border-admin-border"})]}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto space-y-2",children:u?e.jsx("div",{className:"text-center text-admin-text py-8",children:"불러오는 중..."}):h.length===0?e.jsx("div",{className:"text-center text-admin-text py-8",children:"결과가 없습니다"}):h.map(t=>{const s=String(t.제품명||"이름 없음"),o=String(t.업체명||""),i=String(t.상태||"");return e.jsxs("div",{onClick:()=>c(t),className:"bg-admin-bg border border-admin-border hover:border-admin-accent rounded p-4 cursor-pointer transition-colors",children:[e.jsx("div",{className:"font-semibold mb-1",children:s}),o&&e.jsx("div",{className:"text-xs text-admin-accent mb-1",children:o}),i&&e.jsx("div",{className:"text-xs text-admin-text",children:i})]},t._rowIndex)})})]})]})})}function pe(a){if(!a)return"";const r=a.match(/instagram\.com\/([^/?]+)/);if(r)return r[1];if(!a.includes("/"))return a;const l=a.replace(/\/+$/,"").split("/");return l[l.length-1]||a}function ge({open:a,onClose:r,data:l}){const[n,u]=d.useState(!1),g=()=>{const h=l.brandName||"[회사명]",c=l.productName||"[제품명]";return`[${h} x 디어데이즈] 공동구매 제안 ${c}`},p=()=>{const h=l.productName||"[제품명]",c=l.brandName||"[회사명]";let t="";return l.influencers.forEach((s,o)=>{if(s.name||s.profileUrl){const i=s.name||"[이름]",b=s.profileUrl?pe(s.profileUrl):"handle",D=s.followers||"-",N=s.avgViews||"-",I=s.profileUrl?s.profileUrl:`https://www.instagram.com/${b}/`,E=s.category||"살림",$=s.maxComments&&s.maxComments!=="-"?` | 공구활성 댓글 ${s.maxComments}+`:"";t+=`${o+1}. @${b} | ${i} | 팔로워 ${D} | 평균 릴스 조회수 ${N}
   ${I}
   • ${E} 카테고리${$}

`}}),`안녕하세요, ${c} 담당자님.

공동구매 전문 에이전시 디어데이즈의 정준기 이사입니다.

${c}의 「${h}」를 살펴보니, 저희 협력 인플루언서들과 매우 좋은 핏을 가질 것 같아 연락드렸습니다.

■ 추천 인플루언서
공구 실적, 팔로워 소통도, 콘텐츠 품질 등 내부 검토를 거쳐 매칭한 인플루언서입니다.

${t}■ 최근 유사 카테고리 성과

• 키친 브랜드: N차 공구 진행, 인지도 제로 → 5차 연속 공구
• 식품 브랜드: 론칭 6시간 만에 첫 공구물량 전량소진 → N차 공구 진행
• 라이프스타일 브랜드: 신규 고객 유입 300% 증가
• 유아 브랜드: 3천만원 이상 매출

「${h}」도 좋은 결과를 기대할 수 있도록 하겠습니다.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ 디어데이즈

• 누적 400건 이상의 공동구매 진행
• 300명 이상의 검증된 인플루언서와 직접 협업
• 콘텐츠 기획부터 판매 운영까지 원스톱 진행
• 데이터 기반 매칭으로 최적의 인플루언서 연계

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

해당 상품 또는 다른 상품으로 공동구매 진행이 가능하시다면, 편하신 채널(전화·이메일·카카오톡)로 회신 부탁드립니다.
또한 협업 전 궁금한 사항이 있다면 언제든지 전화주셔도 좋습니다.

감사합니다.
정준기 드림`},x=async()=>{const h=g(),c=p(),t=`제목: ${h}

${c}`;try{await navigator.clipboard.writeText(t),u(!0),C.success("이메일 내용이 복사되었습니다"),setTimeout(()=>u(!1),2e3)}catch(s){console.error("Failed to copy:",s),C.error("복사에 실패했습니다")}};return e.jsx(B,{open:a,onOpenChange:r,children:e.jsxs(z,{className:"max-w-3xl max-h-[80vh] bg-admin-card border-admin-border text-white",children:[e.jsx(U,{children:e.jsx(Y,{className:"text-white",children:"이메일 생성"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-2 block",children:"제목"}),e.jsx("div",{className:"bg-admin-bg border border-admin-border rounded px-4 py-3 text-sm",children:g()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-admin-text mb-2 block",children:"본문"}),e.jsx("div",{className:"bg-admin-bg border border-admin-border rounded p-4 max-h-[40vh] overflow-y-auto",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap font-sans",children:p()})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(y,{variant:"outline",onClick:r,className:"border-admin-border hover:bg-admin-bg",children:"닫기"}),e.jsx(y,{onClick:x,className:"bg-admin-accent hover:bg-admin-accent/90 text-admin-bg",children:n?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"복사됨"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"클립보드에 복사"]})})]})]})]})})}function we(){const{formData:a,proposalDate:r,setProposalDate:l,updateField:n,addInfluencer:u,removeInfluencer:g,updateInfluencer:p,loadProposalData:x}=oe(),{data:h}=ee(),c=X();d.useEffect(()=>{const m=c.state;m&&(x({...m.productName&&{productName:m.productName},...m.brandName&&{brandName:m.brandName},...m.influencers&&{influencers:m.influencers}}),window.history.replaceState({},""))},[]);const t=d.useDeferredValue(a),[s,o]=d.useState(!1),[i,b]=d.useState(!1),[D,N]=d.useState(!1),I=m=>{const P=h?.data||[],j=m.influencerIds.map(S=>{const f=P.find(w=>String(w.인스타ID||"")===S);return f?{id:crypto.randomUUID(),name:String(f["인스타 이름"]||S),followers:O(String(f.팔로워||"")),category:String(f["카테고리(대)"]||""),profileUrl:String(f["프로필 링크"]||`https://instagram.com/${S}`),avgViews:O(String(f["최근 10 평균 릴스 조회수"]||"")),engagementRate:"",maxComments:O(String(f["공구 최대댓글수"]||"")),commentActivity:(()=>{const w=String(f.댓글활동여부||"").trim().toUpperCase();return w==="Y"||w==="O"?"Y":"N"})()}:{id:crypto.randomUUID(),name:S,followers:"",category:"",profileUrl:`https://instagram.com/${S}`,avgViews:"",engagementRate:"",maxComments:"",commentActivity:""}});x({productName:m.productName,brandName:m.brandName,influencers:j})},E=m=>{const P=m.map(ne);x({influencers:[...a.influencers,...P]})},$=async()=>{if(!a.productName){C.error("제품명을 입력해주세요");return}try{const m=(await L(async()=>{const{default:F}=await import("./html2canvas.esm-DXEQVQnt.js");return{default:F}},[])).default,P=(await L(async()=>{const{default:F}=await import("./jspdf.es.min-Cy7lqWaa.js").then(q=>q.j);return{default:F}},__vite__mapDeps([0,1,2]))).default,j=document.getElementById("proposal-preview");if(!j)throw new Error("Preview element not found");C.info("PDF 생성 중...");const S=j.style.transform,f=j.style.transformOrigin;j.style.transform="none",j.style.transformOrigin="";const w=await m(j,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#16161c"});j.style.transform=S,j.style.transformOrigin=f;const k=210,V=297,_=w.height*k/w.width,A=Math.max(_,V),R=new P("p","mm",[k,A]);R.setFillColor(22,22,28),R.rect(0,0,k,A,"F");const G=w.toDataURL("image/png");R.addImage(G,"PNG",0,0,k,_);const W=`제안서_${a.brandName||a.productName}_${r.replace(/\./g,"")}.pdf`;R.save(W),C.success("PDF가 저장되었습니다")}catch(m){console.error("Failed to save PDF:",m),C.error("PDF 저장에 실패했습니다")}},H=()=>{if(!a.productName){C.error("제품명을 입력해주세요");return}N(!0)};return e.jsxs("div",{className:"flex flex-col lg:flex-row min-h-screen lg:h-screen bg-admin-bg",children:[e.jsx(de,{formData:a,proposalDate:r,onDateChange:l,onFieldUpdate:n,onAddInfluencer:u,onRemoveInfluencer:g,onUpdateInfluencer:p,onOpenInfluencerBrowser:()=>o(!0),onOpenProductBrowser:()=>b(!0),onSavePDF:$,onGenerateEmail:H}),e.jsx("div",{className:"flex-1 lg:overflow-hidden",children:e.jsx(he,{data:t,proposalDate:r})}),e.jsx(te,{open:s,onClose:()=>o(!1),onConfirm:E,disabledIds:new Set(a.influencers.map(m=>m.profileUrl?.match(/instagram\.com\/([^/?]+)/)?.[1]||"").filter(Boolean))}),e.jsx(ue,{open:i,onClose:()=>b(!1),onLoadProduct:I}),e.jsx(ge,{open:D,onClose:()=>N(!1),data:a})]})}export{we as default};
