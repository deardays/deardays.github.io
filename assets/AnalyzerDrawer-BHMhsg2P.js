import{j as e}from"./framer-motion-6E75tBg3.js";import{r as w}from"./react-vendor-9l3RvKiN.js";import{b as M}from"./tanstack-query-BtejbdqV.js";import{c as k,t as V}from"./index-kvcITcEx.js";import{B as h,X as _}from"./SortPanel-CCg77oLu.js";import{a as T,b as q,u as A,f as l,c as B}from"./useAnalyzerData-B2JgJSSy.js";import{C as H}from"./copy-Ck-R7ZBU.js";const Q=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],R=k("save",Q);const F=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],G=k("sparkles",F);function Z({payload:s,isOpen:c,onClose:o}){const f=M(),{category:a,isClassifying:g,error:u,classify:y}=T(),{isSaving:j,saved:b,error:p,save:C}=q(),{copied:S,copy:z}=A();if(w.useEffect(()=>{if(!c)return;const t=m=>{m.key==="Escape"&&o()};return document.addEventListener("keydown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}},[c,o]),w.useEffect(()=>{if(b&&s){const t=new Date().toISOString().slice(0,10),m=a;f.setQueryData(["influencers"],x=>x&&{...x,data:x.data.map(r=>String(r.인스타ID)!==s.username?r:{...r,"인스타 이름":s.profile.displayName||r["인스타 이름"],팔로워:String(s.profile.followers),"최근 10 평균 릴스 조회수":String(s.stats.avgViews),"최대 릴스 조회수":String(s.stats.maxViews),"공구 평균좋아요수":String(s.stats.avgLikes),"공구 최대좋아요수":String(s.stats.maxLikes),"공구 평균댓글수":String(s.stats.avgComments),"공구 최대댓글수":String(s.stats.maxComments),"마지막 피드 게시일":s.stats.lastPostDate||r["마지막 피드 게시일"],업데이트일자:t,설명란:s.profile.bio||r.설명란,외부링크:s.profile.externalLink||r.외부링크,"프로필 링크":s.profile.profileLink||r["프로필 링크"],...m?{"카테고리(대)":m.대,"카테고리(중)":m.중.join(", ")}:{}})}),V.success("시트에 저장되었습니다")}},[b,s,a,f]),!c||!s)return null;const{profile:n,stats:i,feedPosts:D,reels:E}=s,v=D.filter(t=>!t.isPinned&&t.isDeal),N=E.filter(t=>!t.isPinned),L=()=>{y(n.bio,s.username)},P=()=>{z(B(s,a))},I=()=>{C(s,a)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/50",onClick:o}),e.jsxs("div",{className:"fixed inset-0 sm:inset-y-0 sm:left-auto sm:right-0 z-[9999] w-full sm:w-[400px] bg-admin-bg border-l border-admin-border flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between px-4 py-3 border-b border-admin-border bg-admin-bg",children:[e.jsx("h2",{className:"text-white font-semibold text-sm",children:"IG 분석 결과"}),e.jsx(h,{variant:"ghost",size:"icon-sm",onClick:o,className:"text-admin-text hover:text-white hover:bg-admin-card",children:e.jsx(_,{className:"size-4"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-admin-border flex items-center justify-center text-sm text-white",children:"@"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h3",{className:"text-white font-semibold text-sm truncate",children:["@",n.username]}),n.displayName&&e.jsx("p",{className:"text-admin-text text-xs truncate",children:n.displayName})]}),e.jsxs("span",{className:"ml-auto text-admin-accent text-xs font-semibold whitespace-nowrap",children:[l(n.followers)," 팔로워"]})]}),n.bio&&e.jsx("p",{className:"text-admin-text text-xs leading-relaxed line-clamp-3 whitespace-pre-wrap",children:n.bio})]}),e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-white font-semibold text-sm mb-3",children:["릴스 통계 (",N.length,"개)"]}),N.length>0?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsx(d,{label:"평균 조회수",value:l(i.avgViews)}),e.jsx(d,{label:"최대 조회수",value:l(i.maxViews)})]}):e.jsx("p",{className:"text-admin-text text-sm",children:"릴스 없음"})]}),e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsxs("h3",{className:"text-white font-semibold text-sm mb-3",children:["공구 피드 통계 (",v.length,"개)"]}),v.length>0?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsx(d,{label:"평균 좋아요",value:l(i.avgLikes)}),e.jsx(d,{label:"최대 좋아요",value:l(i.maxLikes)}),e.jsx(d,{label:"평균 댓글",value:l(i.avgComments)}),e.jsx(d,{label:"최대 댓글",value:l(i.maxComments)})]}):e.jsx("p",{className:"text-admin-text text-sm",children:"공구 게시물 없음"}),i.lastPostDate&&e.jsxs("p",{className:"text-admin-text text-xs mt-2",children:["최근 게시물: ",i.lastPostDate]})]}),e.jsxs("div",{className:"bg-admin-card border border-admin-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-semibold text-sm mb-3",children:"AI 분류"}),a?e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-admin-accent font-semibold",children:a.대}),a.중.length>0&&e.jsx("span",{className:"text-admin-text ml-2",children:a.중.join(", ")})]}):e.jsx("p",{className:"text-admin-text text-sm",children:"분류 버튼을 눌러주세요"})]}),u&&e.jsx("p",{className:"text-red-400 text-xs",children:u}),p&&e.jsx("p",{className:"text-red-400 text-xs",children:p})]}),e.jsxs("div",{className:"sticky bottom-0 flex gap-2 px-4 py-3 border-t border-admin-border bg-admin-bg",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:L,disabled:g,className:"flex-1 bg-transparent border-admin-border text-white hover:bg-admin-card",children:[e.jsx(G,{className:"size-3.5"}),g?"분류 중...":"분류"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:P,className:"flex-1 bg-transparent border-admin-border text-white hover:bg-admin-card",children:[e.jsx(H,{className:"size-3.5"}),S?"복사됨!":"복사"]}),e.jsxs(h,{size:"sm",onClick:I,disabled:j,className:"flex-1 bg-admin-accent text-admin-bg hover:bg-admin-accent/90",children:[e.jsx(R,{className:"size-3.5"}),j?"저장 중...":b?"저장됨":"저장"]})]})]})]})}function d({label:s,value:c}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-admin-text text-xs",children:s}),e.jsx("p",{className:"text-white font-semibold",children:c})]})}export{Z as default};
